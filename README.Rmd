---
output:
  github_document:
    html_preview: false
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-"
)
```

# {fio}
<div style="text-align: justify">
Friendly & Fast Input-Output Analysis <img src="man/figures/leontief.jpg" align="right" width="240px" style="margin-left: 20px;" />

<!-- badges: start -->
[![CRAN status](https://www.r-pkg.org/badges/version/fio)](https://CRAN.R-project.org/package=fio)
[![R-universe](https://albersonmiranda.r-universe.dev/badges/fio)](https://albersonmiranda.r-universe.dev/fio)
[![R-CMD-check](https://github.com/albersonmiranda/fio/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/albersonmiranda/fio/actions/workflows/R-CMD-check.yaml)
[![Codecov test coverage](https://codecov.io/gh/albersonmiranda/fio/branch/main/graph/badge.svg)](https://app.codecov.io/gh/albersonmiranda/fio?branch=main)
[![Downloads](https://cranlogs.r-pkg.org/badges/grand-total/fio)](https://CRAN.R-project.org/package=fio)
[![DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/albersonmiranda/fio)
[![extendr](https://img.shields.io/badge/extendr-^0.8.1-276DC2)](https://extendr.rs/extendr/extendr_api/)
<!-- badges: end -->

`{fio}` (*Friendly Input-Output*) is a R package designed for economic input-output analysis that combines user-friendly interfaces with high-performance computation. It provides tools for analyzing both single-region and multi-regional economic systems through a hybrid architecture that pairs R's accessibility with [Rust's](https://rust-lang.org/) computational efficiency.

The package is optimized for speed and efficiency. It leverages the [R6 class](https://r6.r-lib.org/) for clean, memory-efficient object-oriented programming. Furthermore, all linear algebra computations are implemented using [faer](https://docs.rs/faer/latest/faer/) Rust crate to achieve highly optimized performance.

## Input-Output Analysis?

Input-output analysis is a quantitative economic technique that examines inter-industry relationships within an economy. Developed by the Russian-American economist Wassily Leontief, it models how the output of one industry serves as input to other industries, allowing analysts to trace the ripple effects of changes in production, demand, or policy throughout an economic system.

The fio package implements input-output analysis using two computational
paradigms:

- Demand-side (Leontief) model: Traces how changes in final demand propagate backward through supply chains, calculating the total production required across all sectors to satisfy a given level of final demand.
- Supply-side (Ghosh) model: Traces how changes in primary inputs propagate forward through production chains, analyzing how changes in value-added components affect sectoral outputs.

Both approaches rely on matrix algebra operations implemented in Rust for computational efficiency, with R6 classes providing the R user-facing interface.

## Features

{fio} is able to:

- Single-region capabilities:
  - Compute core matrices (technical and allocation coefficients, Leontief and Ghoshian inverses)
  - Multipliers (output, employment, wages, taxes)
  - Structural Analysis (key sectors, field of influence, hypothetical extraction)
  - Model closure (household and government)
- Multi-region inherits all single-region capabilities and adds:
  - Bilateral trade
  - Multi-regional multipliers
  - Spillover matrices
  - Regional interdependence
  - Country extraction for single-region analysis from multi-region data

{fio} also includes an utility function to download input-output data from University of Groningen's [World Input-Output Database (WIOD)](https://www.rug.nl/ggdc/valuechain/wiod/?lang=en). Furthermore, it counts with a companion data package [{fiodata}](https://github.com/albersonmiranda/fiodata) that includes two real world datasets --- `br_2020` for single-region and `world_2000` for multi-region analysis --- in raw format (.xlsx) and R-ready (.rda) for analysis and experimenting with {fio}. 

## Installation

### CRAN Release

You can install the latest release of {fio} from CRAN with:

```r
install.packages("fio")
```

### Development version

You can install the precompiled binaries from Github's `main` branch from R-Universe:

```r
install.packages("fio", repos = c("https://albersonmiranda.r-universe.dev", "https://cloud.r-project.org"))
```

For bleeding edge development branches, other than `main`, compiling from source requires [Rust](https://rust-lang.org/) to be installed on your system. You can install Rust from your OS package manager or, preferably, from [official installer](https://rust-lang.org/tools/install/). Then:

```r
remotes::install_github("albersonmiranda/fio", ref = "branch-name")
```

## Getting Started

If you are just getting started with `{fio}`, we recommend you to read the [vignettes](https://albersonmiranda.github.io/fio/articles/index.html) for a comprehensive overview of the package.

## Single-region input-output analysis

```{r example}
# load included dataset
iom_br <- fiodata::br_2020

# compute technical coefficients matrix
iom_br$compute_tech_coeff()

# compute Leontief's inverse
iom_br$compute_leontief_inverse()

# key sectors
iom_br$compute_key_sectors()
iom_br$key_sectors |> head()

# hypothetical extraction
iom_br$compute_allocation_coeff()
iom_br$compute_hypothetical_extraction()
iom_br$hypothetical_extraction |> head()

# field of influence
iom_br$compute_field_influence(epsilon = 0.001)
iom_br$field_influence[1:5, 1:5]

# closed model
iom_br$close_model("household")
iom_br$compute_tech_coeff()
iom_br$compute_leontief_inverse()
iom_br$compute_key_sectors()
iom_br$key_sectors |> tail() # household consumption is a key sector!
```

## Multi-region input-output analysis

Calculate multi-regional multipliers and interdependence from the 2000 World Input-Output Database (26 countries, 23 sectors):

```{r example_miom}
# load included dataset
miom_world <- fiodata::world_2000

# get bilateral trade (from -> to)
miom_world$get_bilateral_trade("BRA", "CHN")[1:5, 1:2]

# compute multi-regional multipliers
miom_world$compute_multiregional_multipliers()

# show multipliers for specific country-sector pairs
# example: Chemicals from Brazil to China and US
bra_chemicals_index <- which(grepl("BRA.*Chemicals", miom_world$multiregional_multipliers$destination_label))[1]
bra_chemicals <- miom_world$multiregional_multipliers[bra_chemicals_index, ]

# Show key multiplier components
multiplier_cols <- c("destination_label", "intra_regional_multiplier", "spillover_multiplier", "total_multiplier", "multiplier_to_CHN", "multiplier_to_USA")
available_cols <- intersect(multiplier_cols, names(bra_chemicals))
bra_chemicals[, available_cols]

# get regional interdependence
miom_world$get_regional_interdependence() |> head()

# get country summary
miom_world$get_country_summary() |> head()
```
## Related tools

Other great tools for input-output analysis in R include:

- [{leontief}](https://pachamaltese.github.io/leontief/)
- [{ioanalysis}](https://cran.r-project.org/package=ioanalysis)

</div>
